<%- include('includes/head') %>
<%- include('includes/nav') %>

  <div class="row">

    <div class="col-lg-12">
      <div class="text-center">
        <!-- <img src="/img/despesa.jpg" style="width:80px;height:80px;"> -->
        <h4>Gráficos das Despesas</h4>
        <p><%- include('includes/messages') %></p>
      </div>

      <% if(despesas1.length > 0) { %>
        <%- console.log( despesas1 ); %> 
        
        <div style="width:50%;">
          <canvas id="area_graf1"></canvas>
        </div>

        <div style="width:50%;">
          <canvas id="area_graf2"></canvas>
        </div>

        <div style="width:50%;">
          <canvas id="area_graf3"></canvas>
        </div>

      <% } else { %>
        <p class="text-center lead">Não existem despesas cadastradas.</p>
      <% } %>

    </div>
    
  </div>
  
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
  <script src='https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.5.0/Chart.min.js'></script>

  <script>

      //fazer a leitura do conteúdo do obj retornado da consulta (despesas)
      for (const x of <%- despesas3 %>) {

          // Imprime os dados de cada documento
          // const div = document.createElement("div");
          // div.textContent = `Id: ${x._id} | Placa: ${x.placa}`;
          // document.querySelector("#lista").appendChild(div);

          //console.log(x.placa); //irá ser exibido no console do browser
        };


      // crie um gráfico inicial vazio
      var area_graf1 = document.getElementById("area_graf1");
      var myChart1 = new Chart(area_graf1, {
        type: 'bar',
        data: {
                labels: <%- despesas1 %>.map(row => row._id),
                datasets: [{
                            data: <%- despesas1 %>.map(row => row.count),
                            borderWidth: 1,
                            borderColor:'#00c0ef',
                            label: 'Quant registros',
                }]
        },
        options: {
                  responsive: true,
                  title: {
                    display: true,
                    text: "área do gráfico UM",
                  },
                  legend: {
                    display: true
                  },
                  scales: {
                    yAxes: [{
                      ticks: {
                        beginAtZero: true,
                      }
                    }]
                  }
        }
      });


      var area_graf2 = document.getElementById("area_graf2");
      var myChart2 = new Chart(area_graf2, {
        type: 'bar',
        data: {
                labels: <%- despesas2 %>.map(row => row._id),
                datasets: [{
                            data: <%- despesas2 %>.map(row => row.count),
                            borderWidth: 1,
                            borderColor:'#00c0ef',
                            label: 'Quant registros',
                }]
        },
        options: {
                  responsive: true,
                  title: {
                    display: true,
                    text: "área do gráfico DOIS",
                  },
                  legend: {
                    display: true
                  },
                  scales: {
                    yAxes: [{
                      ticks: {
                        beginAtZero: true,
                      }
                    }]
                  }
        }
      });



      var area_graf3 = document.getElementById("area_graf3");
      var myChart3 = new Chart(area_graf3, {
        type: 'bar',
        data: {
                labels: <%- despesas3 %>.map(row => row._id),
                datasets: [{
                            data: <%- despesas3 %>.map(row => row.count),
                            borderWidth: 1,
                            borderColor:'#00c0ef',
                            label: 'Quant registros',
                }]
        },
        options: {
                  responsive: true,
                  title: {
                    display: true,
                    text: "área do gráfico TRÊS",
                  },
                  legend: {
                    display: true
                  },
                  scales: {
                    yAxes: [{
                      ticks: {
                        beginAtZero: true,
                      }
                    }]
                  }
        }
      });      



    </script> 
<%- include('includes/footer') %>
