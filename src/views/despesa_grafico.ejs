<%- include('includes/head') %>
<%- include('includes/nav') %>

  <div class="row">

    <div class="col-lg-12">
      <div class="text-center">
        <!-- <img src="/img/despesa.jpg" style="width:80px;height:80px;"> -->
        <h4>Gráficos das Despesas</h4>
        <p><%- include('includes/messages') %></p>
      </div>

      <% if(despesas1.length > 0) { %>
        <%- console.log( despesas1 ); %> 
        <div class="container" style="display: flex; justify-content: space-around;">
        <div style="width:50%; border: solid 1px rgba(15, 14, 14, 0.5);">
          <canvas id="area_graf1"></canvas>   
        </div>

        <div style="width:50%; border: solid 1px rgba(15, 14, 14, 0.5);">
          <canvas id="area_graf2"></canvas>
        </div>
        </div>

        <div class="container" style="display: flex; justify-content: space-around;">
        <div style="width:50%; border: solid 1px rgba(15, 14, 14, 0.5);">
          <canvas id="area_graf3"></canvas>
        </div>

        <div style="width:50%; border: solid 1px rgba(15, 14, 14, 0.5);">
          <canvas id="area_graf4"></canvas>
        </div>
        </div>

      <% } else { %>
        <p class="text-center lead">Não existem despesas cadastradas.</p>
      <% } %>

    </div>
    
  </div>
  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.1/chart.umd.js"></script>

  <script>
      // import Chart from 'chart.js/auto'

      // crie um gráfico inicial vazio
      var area_graf1 = document.getElementById("area_graf1");
      var myChart1 = new Chart(area_graf1, {
        type: 'pie',
        data: {
          labels: <%- despesas1 %>.map(row => row._id),
          datasets: [{
            label: "Qtd despesas cadastradas",
            backgroundColor: ["#228b22", "#ffd700"],
            data: <%- despesas1 %>.map(row => row.count)
          }]
        },
        options: {
          responsive: true,
          plugins: {
            subtitle: {
              display: true,
              text: "Número de despesas registradas",
            },
            legend: {
              display: true
            },
          }
        }
      });


      //var area_graf2 = document.getElementById("area_graf2");
      new Chart(document.getElementById("area_graf2"), {
        type: 'doughnut',
        data: {
          labels: <%- despesas2 %>.map(row => row._id),
          datasets: [
            {
              label: "Qtd:",
              backgroundColor: ["#3cba9f","#e8c3b9","#c45850"],
              data: <%- despesas2 %>.map(row => row.count)
            }
          ]
        },
        options: {
          responsive: true,
          plugins: {
            subtitle: {
              display: true,
              text: "Número de despesas registradas",
            },
            legend: {
              display: true
            },
          }
        }
      });


      var area_graf3 = document.getElementById("area_graf3");
      var myChart3 = new Chart(area_graf3, {
        type: 'bar',
        data: {
                labels: <%- despesas3 %>.map(row => row._id),
                datasets: [{
                            data: <%- despesas3 %>.map(row => row.count),
                            borderWidth: 1,
                            borderColor:'#00c0ef',
                            label: 'Quant registros',
                            backgroundColor: 'rgb(255, 255, 1)',
                }]
        },
        options: {
                  responsive: true,
                  plugins: {
                  subtitle: {
                    display: true,
                    text: "Número de despesas no veículo XXX por tipo",
                  },
                  legend: {
                    display: false
                  },
                  },
                  scales: {
                    yAxes: [{
                      ticks: {
                        beginAtZero: true,
                      }
                    }]
                  }
        }
      });


      //var area_graf4 = document.getElementById("area_graf4");
      new Chart(document.getElementById("area_graf4"), {
      type: 'bar',
      data: {
        labels: <%- despesas4 %>.map(row => row.count),
        datasets: [
          {
            label: "Placa",
            backgroundColor: "#3e95cd",
            data: <%- despesas4 %>.map(row => row._id.campo1)
          }, {
            label: "Tipo",
            backgroundColor: "#8e5ea2",
            data: <%- despesas4 %>.map(row => row._id.campo2)
          }
        ]
      },
      options: {
        title: {
          display: true,
          text: 'Population growth (millions)'
        }
      }
      });
      /* var myChart4 = new Chart(area_graf4, {
        type: 'bar',
        data: {
                labels: <%- despesas4 %>.map(row => row._id.campo2),
                datasets: [{
                            data: <%- despesas4 %>.map(row => row.count),
                            borderWidth: 1,
                            borderColor:'',
                            label: 'teste4',
                            backgroundColor: 'rgb(255, 255, 1)',
                }]
        },
        options: {
                  responsive: true,
                  plugins: {
                    subtitle: {
                      display: true,
                      text: 'area 4',
                    },
                    legend: {
                      labels: {
                        font: { size: 8 }
                      }
                    }
                  },
                  
                  scales: {
                    y: {
                      beginAtZero: true,
                    }
                  },
        }
      });    */    



    </script> 
<%- include('includes/footer') %>
